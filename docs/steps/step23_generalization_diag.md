# Step 23: 泛化能力诊断 — 系统是在"学道理"还是"背答案"?

> 日期: 2026-02-08
> 状态: ✅ 完成

## 目标

验证 DA-STDP 学到的是通用策略还是特定地图记忆

## 测试方法

```
A: 在 seed=42 地图训练 2000 步 → 测试后 500 步表现
B: 全新未训练 agent 在不同 seed 地图跑 500 步
对比: 训练过的 A 是否比未训练的 B 表现更好?
```

## 结果

```
seed= 77: trained=0.50  fresh=0.69  Δ=-0.19
seed=123: trained=0.53  fresh=0.47  Δ=+0.05
平均:     trained=0.515 fresh=0.584 泛化优势=-0.069

结论: ❌ 训练有害 — 过拟合了特定布局
```

**训练不但没帮助，反而比完全不训练的差 6.9%。**

## 根因分析

DA-STDP 学到的不是 "看到亮像素(食物)→靠近"，而是 "这些特定 V1 神经元激活→向左走"。
原因：V1→dlPFC→BG 直连，没有视觉层级抽象。

```
人脑: 视网膜 → V1(边缘) → V2(纹理) → V4(形状) → IT("这是食物!")
      → PFC("食物在左!") → BG("向左走!")
      IT 的 "食物" 表征对位置/角度/大小不变 → 换地图也认得

悟韵: 视网膜 → V1(原始像素模式) → dlPFC(弥散转发) → BG("模式X→向左")
      V1 的模式和食物位置强耦合 → 食物换位置就废了
```

## 启示

之前 Step 11-22 的所有"学习提升"(improvement +0.16 等)都是**同一张地图上的记忆效应**，不是泛化学习。
继续调参不会解决这个问题——需要架构改进。

## 下一步方向

最高优先级: **视觉层级接入闭环** (V1→V2→V4→IT→dlPFC→BG)
- build_standard_brain 已有 V2/V4/IT，但 ClosedLoopAgent 只用了 V1
- IT 层的不变性表征是泛化的硬件基础
- 这是架构决策，不是参数调优

## 回归测试: 29/29 CTest 全通过 (泛化测试是诊断性，不影响通过)

## 系统状态

```
50区域 · ~115投射 · 29 CTest suites
泛化诊断: ❌ 训练有害 (-6.9%), 系统在"背答案"不是"学道理"
根因: 缺视觉层级抽象 (V1 直连 BG, 无不变性表征)
下一步: V2/V4/IT 接入闭环, 提供位置不变的食物/危险表征
```
